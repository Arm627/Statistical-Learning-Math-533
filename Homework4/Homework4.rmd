---
title: "Homework 4"
author: "Brandon Amaral, Monte Davityan, Nicholas Lombardo, Hongkai Lu"
date: '2022-10-03'
output: pdf_document
---

```{r setup, include=FALSE} 
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
options(knitr.kable.NA = '')
set.seed(123)
```

## 1 Murphy Chapter 13 & ISLR Chapter 10 Summaries



## 2 Reproduction of ISLR Lab 10.9
### 10.9.1 A Single Layer Network on the Hitters Data
First, We load the Hitters data and split it to training and test set.

```{r}
library(ISLR2)
Gitters <- na.omit(Hitters)
n <- nrow(Gitters)
set.seed(13)
ntest <- trunc(n/3)
testid <- sample(1:n, ntest)
```

Then, we fit a linear model and obtain the mean absolute prediction error, which is 254.6687.
```{r}
lfit <- lm(Salary ~., data=Gitters[-testid,])
lpred <- predict(lfit, Gitters[testid,])
with(Gitters[testid,], mean(abs(lpred - Salary)))
```

Next, we fit a lasso model. Similarly, we calculate the absolute prediction error of the lasso model, which is slightly less than the result of linear model.
```{r}
x <- scale(model.matrix(Salary ~. -1, data=Gitters))
y <- Gitters$Salary

library(glmnet)
cvfit <- cv.glmnet(x[-testid, ], y[-testid], type.measure='mae')
cpred <- predict(cvfit, x[testid,], s='lambda.min')
mean(abs(y[testid] - cpred))
```
Last




## 3 ISLR Problems

### 10.7

### 10.8